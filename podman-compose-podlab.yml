services:
  backend:
    build:
      context: /Work/financebud
      dockerfile_inline: |
        FROM python:3.11-slim
        WORKDIR /app
        COPY requirements.txt .
        RUN pip install --no-cache-dir -r requirements.txt
    env_file:
      - stack.env
    environment:
      - DATABASE_PATH=/app/financial_data.db
      - STATEMENTS_DIR=/app/Bank-Statements
      - APP_HOME=/app
    command: sh -c "python3 consolidate_statements.py && python -m uvicorn backend.main:app --host 0.0.0.0 --port 8000"
    volumes:
      - /home/notroot/Work/financebud/:/app
    networks:
      - web_application_network

networks:
  web_application_network:
    external: true
    name: podlab_web_application_network